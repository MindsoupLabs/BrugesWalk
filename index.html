<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Interactive Map</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/panzoom@9.4.0/dist/panzoom.min.js"></script>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            touch-action: none;
        }
        #map-container {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background-color: #f0f0f0;
        }
        #map-image {
            display: block;
            max-width: none;
            transform-origin: 0 0;
            touch-action: none;
            user-select: none;
        }
        .controls {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .control-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            background: white;
            border: 1px solid #ccc;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            user-select: none;
        }
    </style>
</head>
<body class="bg-gray-100">
    <div id="map-container">
        <img id="map-image" src="assets/map.jpg" alt="Interactive Map">
    </div>

    <div class="controls">
        <button id="zoom-in" class="control-btn">+</button>
        <button id="zoom-out" class="control-btn">-</button>
        <button id="reset" class="control-btn">‚ü≤</button>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const container = document.getElementById('map-container');
            const element = document.getElementById('map-image');
            
            // Initialize panzoom
            const panzoom = Panzoom(element, {
                maxScale: 5,
                minScale: 0.5,
                step: 0.1,
                contain: 'outside',
                startScale: 1,
                disablePan: false,
                panOnlyWhenZoomed: true
            });

            // Make parent a zoom zone
            container.addEventListener('wheel', panzoom.zoomWithWheel);
            
            // Mobile touch handling
            let touchStartDistance = 0;
            let initialScale = 1;
            
            container.addEventListener('touchstart', function(e) {
                if (e.touches.length === 2) {
                    e.preventDefault();
                    const touch1 = e.touches[0];
                    const touch2 = e.touches[1];
                    touchStartDistance = Math.hypot(
                        touch2.pageX - touch1.pageX,
                        touch2.pageY - touch1.pageY
                    );
                    initialScale = panzoom.getScale();
                }
            }, { passive: false });
            
            container.addEventListener('touchmove', function(e) {
                if (e.touches.length === 2) {
                    e.preventDefault();
                    const touch1 = e.touches[0];
                    const touch2 = e.touches[1];
                    const touchEndDistance = Math.hypot(
                        touch2.pageX - touch1.pageX,
                        touch2.pageY - touch1.pageY
                    );
                    
                    if (touchStartDistance) {
                        const scale = (touchEndDistance / touchStartDistance) * initialScale;
                        const rect = container.getBoundingClientRect();
                        const x = (touch1.clientX + touch2.clientX) / 2 - rect.left;
                        const y = (touch1.clientY + touch2.clientY) / 2 - rect.top;
                        panzoom.zoom(scale, { animate: false, force: true, focal: { x, y } });
                    }
                }
            }, { passive: false });
            
            container.addEventListener('touchend', function() {
                touchStartDistance = 0;
            });

            // Control buttons
            document.getElementById('zoom-in').addEventListener('click', () => {
                panzoom.zoomIn({ step: 0.5 });
            });
            
            document.getElementById('zoom-out').addEventListener('click', () => {
                panzoom.zoomOut({ step: 0.5 });
            });
            
            document.getElementById('reset').addEventListener('click', () => {
                panzoom.reset();
            });

            // Handle window resize
            function handleResize() {
                const container = document.getElementById('map-container');
                const img = document.getElementById('map-image');
                
                // Reset image size to natural size
                img.style.width = 'auto';
                img.style.height = 'auto';
                
                // Get the container dimensions
                const containerWidth = container.clientWidth;
                const containerHeight = container.clientHeight;
                
                // Get the image dimensions
                const imgWidth = img.naturalWidth || img.width;
                const imgHeight = img.naturalHeight || img.height;
                
                // Calculate the scale to fit the container
                const scaleX = containerWidth / imgWidth;
                const scaleY = containerHeight / imgHeight;
                const scale = Math.min(scaleX, scaleY);
                
                // Apply initial scale
                panzoom.zoom(scale);
                
                // Center the image
                const x = (containerWidth - imgWidth * scale) / 2;
                const y = (containerHeight - imgHeight * scale) / 2;
                panzoom.pan(x, y, { force: true });
            }

            // Initial setup
            window.addEventListener('load', handleResize);
            window.addEventListener('resize', handleResize);
            
            // Disable right-click context menu on the image
            element.addEventListener('contextmenu', (e) => e.preventDefault());
        });
    </script>
</body>
</html>
